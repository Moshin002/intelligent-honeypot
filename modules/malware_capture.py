import hashlib
import logging
from pathlib import Path


class MalwareCapture:

    def __init__(self):
        Path('captured_malware').mkdir(exist_ok=True)
        self.logger = logging.getLogger('malware_capture')

    def save_malware(self, data, source_ip):
        file_hash = hashlib.sha256(data).hexdigest()
        filename = f"captured_malware/{source_ip}_{file_hash[:8]}.bin"

        with open(filename, 'wb') as f:
            f.write(data)

        self.logger.info(f"Malware captured: {filename}")
